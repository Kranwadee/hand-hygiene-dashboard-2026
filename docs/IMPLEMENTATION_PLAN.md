# üìã Implementation Plan: Google Sheets Backend Integration

## üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö Backend ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Hand Hygiene Dashboard ‡∏ó‡∏µ‡πà:
- ‚úÖ ‡∏û‡∏µ‡πà‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢
- ‚úÖ ‡∏£‡∏∏‡πà‡∏ô‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ
- ‚úÖ Export CSV ‡πÑ‡∏î‡πâ
- ‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Web App ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÑ‡∏î‡πâ
- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Real-time (Polling)

---

## üìê Architecture Overview

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         SYSTEM ARCHITECTURE                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                  ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îÇ
‚îÇ   ‚îÇ Manual Input ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Google Sheets     ‚îÇ              ‚îÇ
‚îÇ   ‚îÇ (‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)  ‚îÇ         ‚îÇ   (Database)        ‚îÇ              ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ                     ‚îÇ              ‚îÇ
‚îÇ                            ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ              ‚îÇ
‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ  ‚îÇ employees     ‚îÇ  ‚îÇ              ‚îÇ
‚îÇ   ‚îÇ Friend's App ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  ‚îÇ records       ‚îÇ  ‚îÇ              ‚îÇ
‚îÇ   ‚îÇ (UV Camera)  ‚îÇ  API    ‚îÇ  ‚îÇ departments   ‚îÇ  ‚îÇ              ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ  ‚îÇ activities    ‚îÇ  ‚îÇ              ‚îÇ
‚îÇ                            ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ              ‚îÇ
‚îÇ                            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ
‚îÇ                                       ‚îÇ                          ‚îÇ
‚îÇ                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ                    ‚îÇ                  ‚îÇ                  ‚îÇ      ‚îÇ
‚îÇ                    ‚ñº                  ‚ñº                  ‚ñº      ‚îÇ
‚îÇ            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ            ‚îÇ Hospital   ‚îÇ    ‚îÇ Department ‚îÇ    ‚îÇ Personal   ‚îÇ   ‚îÇ
‚îÇ            ‚îÇ Dashboard  ‚îÇ    ‚îÇ Dashboard  ‚îÇ    ‚îÇ Dashboard  ‚îÇ   ‚îÇ
‚îÇ            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìä Phase 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets Structure (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1)

### 1.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡πÉ‡∏´‡∏°‡πà
- ‡∏ä‡∏∑‡πà‡∏≠: `Hand_Hygiene_Database_2026`
- ‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ: ‡∏û‡∏µ‡πà‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å IC (Editor), ‡∏£‡∏∏‡πà‡∏ô‡∏ô‡πâ‡∏≠‡∏á (Editor)

### 1.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á Sheets (Tabs)

#### Sheet 1: `employees` (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)
| Column | ‡∏ä‡∏∑‡πà‡∏≠ | Type | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á |
|--------|-----|------|---------|
| A | `emp_id` | Text | EMP001 |
| B | `name_th` | Text | ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ |
| C | `name_en` | Text | Somchai Jaidee |
| D | `department` | Text | ICU |
| E | `position` | Text | ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• |
| F | `status` | Text | active / inactive |

#### Sheet 2: `departments` (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏Å)
| Column | ‡∏ä‡∏∑‡πà‡∏≠ | Type | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á |
|--------|-----|------|---------|
| A | `dept_code` | Text | ICU |
| B | `dept_name_th` | Text | ‡∏´‡∏≠‡∏≠‡∏†‡∏¥‡∏ö‡∏≤‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏´‡∏ô‡∏±‡∏Å |
| C | `dept_name_en` | Text | Intensive Care Unit |
| D | `head_id` | Text | EMP001 |
| E | `employee_count` | Number | 25 |

#### Sheet 3: `records` (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠) ‚≠ê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
| Column | ‡∏ä‡∏∑‡πà‡∏≠ | Type | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á |
|--------|-----|------|---------|
| A | `record_id` | Text (auto) | REC-20260130-001 |
| B | `emp_id` | Text | EMP001 |
| C | `activity_id` | Text | ACT-2026-01 |
| D | `timestamp` | DateTime | 2026-01-30 09:30:00 |
| E | `front_score` | Number | 85 |
| F | `back_score` | Number | 90 |
| G | `zone_1` | Boolean | TRUE |
| H | `zone_2` | Boolean | FALSE |
| I | `zone_3` | Boolean | TRUE |
| J | `zone_4` | Boolean | FALSE |
| K | `zone_5` | Boolean | FALSE |
| L | `zone_6` | Boolean | TRUE |
| M | `zone_7` | Boolean | FALSE |
| N | `zone_8` | Boolean | FALSE |
| O | `zone_9` | Boolean | FALSE |
| P | `zone_10` | Boolean | FALSE |
| Q | `zone_11` | Boolean | TRUE |
| R | `image_url` | URL | (optional) link to UV image |
| S | `notes` | Text | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |

> **Note**: zone_1 - zone_11 = TRUE ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á ‡∏à‡∏∏‡∏î‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡∏™‡∏¥‡πà‡∏á‡∏™‡∏Å‡∏õ‡∏£‡∏Å‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà (‡∏•‡πâ‡∏≤‡∏á‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏≠‡∏≤‡∏î)

#### Sheet 4: `activities` (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°)
| Column | ‡∏ä‡∏∑‡πà‡∏≠ | Type | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á |
|--------|-----|------|---------|
| A | `activity_id` | Text | ACT-2026-01 |
| B | `activity_name` | Text | Hand Hygiene Week Q1/2026 |
| C | `start_date` | Date | 2026-01-27 |
| D | `end_date` | Date | 2026-01-31 |
| E | `target_participants` | Number | 500 |
| F | `status` | Text | active / completed |

---

## üîå Phase 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Apps Script API (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2)

### 2.1 ‡πÄ‡∏õ‡∏¥‡∏î Apps Script
1. ‡πÉ‡∏ô Google Sheets ‚Üí Extensions ‚Üí Apps Script
2. ‡∏•‡∏ö code ‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏™‡πà code ‡πÉ‡∏´‡∏°‡πà

### 2.2 Code Template
‡∏î‡∏π code ‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå `scripts/apps_script.js`

### 2.3 Deploy ‡πÄ‡∏õ‡πá‡∏ô Web App
1. Deploy ‚Üí New deployment
2. Type: Web app
3. Execute as: Me
4. Who has access: Anyone
5. Copy URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ (‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Dashboard)

---

## üîó Phase 3: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Dashboard (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2-3)

‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á code ‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå `scripts/dashboard_api.js`

### ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

| File | ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ |
|------|-------------|
| `hospital-dashboard.html` | ‡πÅ‡∏ó‡∏ô mock data, ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API |
| `department-dashboard.html` | ‡πÅ‡∏ó‡∏ô mock data, ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API |
| `personal-dashboard.html` | ‡πÅ‡∏ó‡∏ô mock data, ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API |

---

## üìÑ Phase 4: Documentation (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 3-4)

‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô folder `docs/`

---

## ‚è∞ Timeline Summary

| ‡∏ß‡∏±‡∏ô | ‡∏á‡∏≤‡∏ô | ‡πÄ‡∏ß‡∏•‡∏≤ |
|-----|-----|------|
| 1 | ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets + ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á | 2-3 ‡∏ä‡∏°. |
| 2 | ‡∏™‡∏£‡πâ‡∏≤‡∏á Apps Script API + ‡∏ó‡∏î‡∏™‡∏≠‡∏ö | 3-4 ‡∏ä‡∏°. |
| 2-3 | ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Dashboard ‡∏Å‡∏±‡∏ö API | 3-4 ‡∏ä‡∏°. |
| 3-4 | ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Documentation | 2-3 ‡∏ä‡∏°. |
| 4 | ‡∏ó‡∏î‡∏™‡∏≠‡∏ö + ‡πÅ‡∏Å‡πâ bug | 2-3 ‡∏ä‡∏°. |

**‡∏£‡∏ß‡∏°: ~3-4 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô**

---

## üìù Checklist

### Phase 1: Google Sheets
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡πÉ‡∏´‡∏°‡πà
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet: employees
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet: departments
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet: records
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet: activities
- [ ] ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
- [ ] ‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏°

### Phase 2: Apps Script
- [ ] ‡∏™‡∏£‡πâ‡∏≤‡∏á Apps Script project
- [ ] ‡πÉ‡∏™‡πà code API
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö doGet
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö doPost
- [ ] Deploy ‡πÄ‡∏õ‡πá‡∏ô Web App
- [ ] ‡πÄ‡∏Å‡πá‡∏ö URL ‡πÑ‡∏ß‡πâ

### Phase 3: Dashboard Integration
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° fetch function ‡πÉ‡∏ô hospital-dashboard
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° fetch function ‡πÉ‡∏ô department-dashboard
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° fetch function ‡πÉ‡∏ô personal-dashboard
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö real-time polling
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö filters

### Phase 4: Documentation
- [ ] ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô README_TH.md
- [ ] ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô SETUP_GUIDE.md
- [ ] ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô API_REFERENCE.md
- [ ] Backup Apps Script code

---

*‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢: [‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡πá‡∏Å‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô]*  
*‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: 30 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2569*  
*Version: 1.0*
